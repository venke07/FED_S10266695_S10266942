<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MokeSell - Listing Details</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <!-- ...existing code... -->
    </header>

    <main>
        <a href="listing.html" class="back-arrow">‚Üê Back to Listings</a>
        <div class="product-container">
            <div class="image-gallery">
                <div class="main-image">
                    <img id="mainImage" src="placeholder.jpg" alt="Main Image">
                </div>
                <div class="thumbnail-container"></div>
            </div>
            <div class="product-info">
                <h1 id="productName">Product Name</h1>
                <p class="price" id="productPrice">$0.00</p>
                <p class="description" id="productDescription">Product Description</p>
                <p class="condition" id="productCondition">Condition</p>
                <div class="seller-info">
                    <h2>Seller Information</h2>
                    <div class="seller-profile">
                        <img id="sellerImage" src="images/profile.png" alt="Seller Image">
                        <div class="seller-details">
                            <p id="sellerName">Seller Name</p>
                            <p id="lastActive">Last Active</p>
                        </div>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="chat-btn" onclick="openChat()">Chat</button>
                    <button class="favorite-btn">Favorite</button>
                </div>
            </div>
        </div>
    </main>

    <script src="product.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const listingId = urlParams.get('listingId');
            const listings = JSON.parse(localStorage.getItem('mokesell_listings') || '[]');
            const listing = listings.find(l => l.id === listingId);

            if (!listing) {
                console.error('Listing not found:', listingId);
                return;
            }

            document.getElementById('productName').textContent = listing.name;
            document.getElementById('productPrice').textContent = `$${listing.price}`;
            document.getElementById('productDescription').textContent = listing.description;
            document.getElementById('productCondition').textContent = listing.condition;
            document.getElementById('sellerName').textContent = listing.sellerName;
            document.getElementById('lastActive').textContent = listing.listingTime;

            const mainImage = listing.images && listing.images.length > 0 
                ? listing.images[0] 
                : 'placeholder.jpg';
            document.getElementById('mainImage').src = mainImage;

            const sellerImage = document.getElementById('sellerImage');
            if (sellerImage) {
                sellerImage.src = 'images/profile.png'; // Assuming a default profile image
            }

            const thumbnailContainer = document.querySelector('.thumbnail-container');
            if (thumbnailContainer) {
                thumbnailContainer.innerHTML = ''; // Clear existing thumbnails
                listing.images.forEach((img, index) => {
                    const thumbnail = document.createElement('img');
                    thumbnail.src = img;
                    thumbnail.className = 'thumbnail';
                    thumbnail.onclick = () => changeImage(index);
                    thumbnailContainer.appendChild(thumbnail);
                });
            }
        });

        function changeImage(index) {
            const urlParams = new URLSearchParams(window.location.search);
            const listingId = urlParams.get('listingId');
            const listings = JSON.parse(localStorage.getItem('mokesell_listings') || '[]');
            const listing = listings.find(l => l.id === listingId);
            const mainImage = document.getElementById('mainImage');
            if (mainImage && listing && listing.images[index]) {
                mainImage.src = listing.images[index];
            }
        }

        function openChat() {
            const urlParams = new URLSearchParams(window.location.search);
            const listingId = urlParams.get('listingId');
            window.location.href = `chat.html?listingId=${listingId}`;
        }
    </script>
</body>
</html>
